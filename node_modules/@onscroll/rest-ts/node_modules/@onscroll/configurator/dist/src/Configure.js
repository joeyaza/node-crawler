"use strict";
var InvalidConfigException_1 = require("./Exceptions/InvalidConfigException");
var _ = require("lodash");
var fs = require("fs");
require("rootpath")();
var CONFIG_PATH = "config.json";
function Configure(configPropertyName) {
    return function (target, key) {
        try {
            var configJSON = fs.readFileSync(CONFIG_PATH).toString();
            var config = JSON.parse(configJSON);
            target[key] = _.reduce(_.split(configPropertyName, "."), function (reduced, key) {
                return reduced[key];
            }, config);
            if (_.isEmpty(target[key])) {
                throw new InvalidConfigException_1.InvalidConfigException("Empty config found under: " + configPropertyName);
            }
        }
        catch (exception) {
            throw new InvalidConfigException_1.InvalidConfigException(exception.message);
        }
    };
}
exports.Configure = Configure;
